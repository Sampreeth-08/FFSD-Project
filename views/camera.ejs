<%- include('partials/header') %>

    <div class="camera-container">
        <p class="text-center mt-4 alert-success">
            <%=(typeof successMsg !="undefined" ? successMsg : "" )%>
        </p>
        <p class="text-center mt-4 alert-danger">
            <%=(typeof errorMsg !="undefined" ? errorMsg : "" )%>
        </p>
        <div class="camera">
            <div class="camera-image">
                <% if(typeof image !="undefined" ? image : "" ) {%>
                    <img style="width:400px; height:400px;" src="/img/<%=(typeof image != " undefined" ? image : "" )%>"
                    alt="">
                    <% } else{ %>
                        <img style="width:400px; height:400px;" src="/img/4.jpg" alt="">
                        <% } %>

                            <!-- <img src="/img/4.jpg" alt=""> -->
                            <form action="" class="camera-form" method="post" enctype="multipart/form-data">
                                <div class="form-group">
                                    <input type="file" id="image" name="image" class="form-control" required>
                                </div>
                                <div class="form-group">
                                    <input type="text" id="caption" name="caption" class="form-control"
                                        placeholder="type caption..." required>
                                </div>
                                <div class="form-group">
                                    <input type="text" id="hashtags" name="hashtags" class="form-control"
                                        placeholder="type hashtags..." required>
                                </div>
                                <div class="form-group">
                                    <button type="submit" id="post" name="upload_image_btn"
                                        class="upload-btn">Post</button>
                                </div>
                            </form>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>

    <script>
        const update = document.getElementById('post');
        update.addEventListener('click', function () {
            fetch('https://localhost:3000/camera', {
                method: 'post',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    image: document.getElementById('image').value,
                    caption: document.getElementById('caption').value,
                    hashtags: document.getElementById('hashtags').value,
                    //id:update.baseURI.split('/')[4].split('?')[0]
                })
            }).then(res => {
                if (res.ok) window.location.href = 'http://localhost:3000/camera'
            }).then(response => {
                console.log(response)
            })
        })
    </script>
    </body>

    </html>